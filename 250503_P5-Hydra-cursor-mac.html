<!DOCTYPE html>
<html lang="en">

<head>
  <style>
    body,
    html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
  </style>
  <link rel="stylesheet" type="text/css" href="style.css">
  <meta charset="utf-8" />
</head>

<body>

</body>
<!-- <script src="hydra-synth.js"></script> -->
<!-- <script src="https://unpkg.com/hydra-synth"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.3/p5.js"></script> -->
<script src="libaries/hydra-synth.js"></script>
<script src="libaries/p5.js"></script>
<script>

  let hc = document.createElement('canvas')
  hc.width = window.innerWidth
  hc.height = window.innerHeight
  document.body.appendChild(hc)
  let hydra = new Hydra({ detectAudio: false, canvas: hc })
  // hydra.setResolution(window.innerWidth*2, window.innerHeight*2) // retina res
  noize = noise // use noize() since noise() is taken by p5js

  let pg // store hydra texture
  let effect = [0, 0, 0]



  // sandbox - start
  src(o0)
    .layer(s0)

    // .scrollY(0.002)
    // .scrollX(0.002)
    //.scale(()=> posX, 1.002)
    .scale(() => number, () => number)
    // .scale(1.02, 1.02)
    
    .modulateScale(noize(() => effect[0], () => effect[1]), () => effect[2])
    // .scroll(0.009, 1.001)
    .out()
  // sandbox  - stop

  let img
  let x, y, x2, y2;
  let posX, posY;

  let opposite
  let oppositeX, oppositeY;
  let newMouseX, newMouseY;

  let checkboxes = [];

  let number;

  

  function setup() {
    createCanvas(windowWidth, windowHeight, WEBGL)
    background(0)
    pg = createGraphics(hc.width, hc.height)
    s0.init({ src: drawingContext.canvas })

    for (let i = 0; i < 4; i++) {
    let cb = createCheckbox('', false);
    cb.position(10, 10 + i * 20); // dynamically space them vertically
    checkboxes.push(cb);
  }

  }

  function preload() {
    img = loadImage('img/cursor1.png')
  }

  function draw() {


    clear()
    newMouseX = map(mouseX, 0, width, -width/2, width/2);
    newMouseY = map(mouseY, -height, 0, -height/2, height/2);

    oppositeX = map(mouseX, 0, width, width/2, -width/2);
    oppositeY = map(mouseY, -height, 0, height/2, -height/2);
    

    image(img, newMouseX, newMouseY, img.width / 6, img.height / 6)
    noStroke()
    ellipse(newMouseX, newMouseY, 10)
    // image(img, oppositeX, oppositeY, img.width / 6, img.height / 6)

    pg.drawingContext.drawImage(hc, 0, 0, pg.width, pg.height)

    let move = map(sin(frameCount*0.1), -1, 1, -.01, .01);
    let move2 = map(sin(frameCount*0.1), -1, 1, 3, 15);
    

    if (checkboxes[0].checked()) {
      number = 1.05
    } else {
      number = 1.0
  }
  
  if (checkboxes[1].checked()) {
    effect = [move2, move, 0.01];
  } else {
    effect = [0, 0, 0];
  }

  if (checkboxes[2].checked()) {
    image(img, oppositeX, oppositeY, img.width / 6, img.height / 6)
  } else {
  }

  if (checkboxes[3].checked()) {
    number = 1.005
  }
  

  }



  function keyPressed(){
	if(key == 'S'){
		pg.save('P5LIVE_hydra.png') // save hydra texture
	}
}

</script>

</html>