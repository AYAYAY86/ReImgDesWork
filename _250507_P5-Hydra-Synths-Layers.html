<!DOCTYPE html>
<html lang="en">

<head>
  <style>
    body,
    html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      /* cursor: none; */
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
  </style>
  <link rel="stylesheet" type="text/css" href="style.css">
  <meta charset="utf-8" />
</head>

<body>

</body>
<!-- <script src="hydra-synth.js"></script> -->
<!-- <script src="https://unpkg.com/hydra-synth"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.3/p5.js"></script> -->
<script src="libaries/hydra-synth.js"></script>
<script src="libaries/p5.js"></script>
<script>

let synthCount = 3 // # of hydra instances

// gen hydra instances
let pg = [synthCount],
	hc = [synthCount],
	synth = [synthCount]

for(let i = 0; i < synthCount; i++) {
	hc[i] = document.createElement('canvas') // hydra canvas + custom size
	hc[i].width = 640 // window.innerWidth // for full res
	hc[i].height = 360 // window.innerHeight // for full res

	synth[i] = new Hydra({
		detectAudio: false, // no mic
		canvas: hc[i], // use hydra canvas
		makeGlobal: false, // scoped
	}).synth // scoped hydra
}


// sandbox - start
// access each instance via synth[index]
synth[0].osc(8, .1)
  .colorama(3)
  .modulate(synth[0].noise(5), .3)
	.out()
	
synth[2].src(s0)
	.out()
	
// synth[2].osc(50, .15)
// 	.colorama(3)
// 	.rotate()
// 	.out()


// sandbox - stop

function setup() {
	createCanvas(windowWidth, windowHeight, WEBGL)
	background(0)
	noStroke()
	
	// prep synth layers
	for(let i = 0; i < synthCount; i++) {
		pg[i] = createGraphics(hc[i].width, hc[i].height)
	}
  synth[2].s0.init({ src: drawingContext.canvas });

  for(let i = 0; i < synthCount; i++) {
		pg[i].clear()
		pg[i].drawingContext.drawImage(hc[i], 0, 0, pg[i].width, pg[i].height)
	}
	
	texture(pg[0]) // use hydra 1
	plane(width)

}

function draw() {

	// grab + apply hydra textures


	// texture(pg[1]) 
  // plane(width/2) 
  
  ellipse(mouseX, mouseY, 200)
  
  // use hydra 2
	// translate(0, height/4)
	// rotateY(radians(90))
	// torus(height/5, 40)
	
	// texture(pg[2]) // use hydra 0
	// translate(0, height/4)
	// rotateY(radians(90))
	// torus(height/5, 40)



  }

</script>

</html>