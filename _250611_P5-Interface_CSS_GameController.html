<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JOYSTICK Raster Controller</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            box-sizing: border-box;
            background: #fff;
        }

        #joystick-list {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 20;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #joystick-list div {
            display: flex;
            justify-content: center;
        }

        #joystick-list span {
            margin: 10px;
            font-weight: bold;
            font-size: 2rem;
            color: black;
            transition: all 0.1s;
            font-family: Arial, sans-serif;
        }
    </style>
</head>

<body>
    <div id="joystick-list"></div>
    <script>
        // Grid-Parameter
        let rows = 1;
        let cols = 1;
        let patternOffset = 0;
        let patternArrangement = 1;
        const container = document.getElementById('joystick-list');

        // Schriftarten
        const fonts = [
            'Arial, sans-serif',
            'Courier New, monospace',
            'Times New Roman, serif',
            'Verdana, sans-serif',
            'Georgia, serif',
            'Comic Sans MS, cursive, sans-serif',
            'Impact, fantasy',
            'Tahoma, Geneva, sans-serif'
        ];
        let currentFontIndex = 0;
        let lastButton1State = false;

        // Style-Parameter
        let fontSizeValue = 32;
        let myWordSpacing = 32;
        let myLetterSpacing = 0;
        let myWordMargin = 0;
        let red = 0;
        let green = 0;
        let summe = 0;

        // Grid bauen
        function buildGrid() {
            container.innerHTML = '';
            for (let i = 0; i < rows; i++) {
                const rowDiv = document.createElement('div');
                let dynamicCols = cols + ((i + patternOffset) % patternArrangement);
                for (let j = 0; j < dynamicCols; j++) {
                    const span = document.createElement('span');
                    span.textContent = "JOYSTICK";
                    span.style.fontFamily = fonts[currentFontIndex];
                    span.style.fontSize = fontSizeValue + 'px';
                    span.style.lineHeight = myWordSpacing + 'px';
                    span.style.letterSpacing = myLetterSpacing + 'px';
                    span.style.margin = myWordMargin + 'px';
                    span.style.color = `rgb(${Math.round(red)},${Math.round(green)},255)`;
                    rowDiv.appendChild(span);
                }
                container.appendChild(rowDiv);
            }
        }

        buildGrid();

        // Gamepad-Logik
        function checkGamepad() {
            const gamepads = navigator.getGamepads();
            const gamepad = gamepads[0];

            if (gamepad) {
                // Schriftart wechseln (Button 1)
                let button1Pressed = gamepad.buttons[1].pressed;
                if (button1Pressed && !lastButton1State) {
                    currentFontIndex = (currentFontIndex + 1) % fonts.length;
                    document.querySelectorAll('#joystick-list span').forEach(span => {
                        span.style.fontFamily = fonts[currentFontIndex];
                    });
                }
                lastButton1State = button1Pressed;

                // Schriftgröße & Zeilenabstand (Button 2 + Stick)
                if (gamepad.buttons[2].pressed) {
                    fontSizeValue += gamepad.axes[0] * 2;
                    fontSizeValue = Math.max(10, Math.min(200, fontSizeValue));
                    myWordSpacing += gamepad.axes[1] * 2;
                    myWordSpacing = Math.max(10, Math.min(200, myWordSpacing));
                }
                document.querySelectorAll('#joystick-list span').forEach(span => {
                    span.style.fontSize = fontSizeValue + 'px';
                    span.style.lineHeight = myWordSpacing + 'px';
                });

                // Grid-Pattern ändern (Button 5 + Stick)
                if (gamepad.buttons[5].pressed) {
                    patternOffset += gamepad.axes[0] * 0.1;
                    patternOffset = Math.max(0, Math.min(10, patternOffset));
                    patternArrangement += gamepad.axes[1] * 0.1;
                    patternArrangement = Math.max(1, Math.min(3, patternArrangement));
                    buildGrid();
                }

                // Grid-Größe ändern (Button 4 + Stick)
                if (gamepad.buttons[4].pressed) {
                    cols += gamepad.axes[0] / 5;
                    cols = Math.max(1, Math.round(cols));
                    rows += gamepad.axes[1] / 5;
                    rows = Math.max(1, Math.round(rows));
                    buildGrid();
                }

                // Letter-Spacing & Margin (Button 3 + Stick)
                if (gamepad.buttons[3].pressed) {
                    myLetterSpacing += gamepad.axes[0];
                    myWordMargin += gamepad.axes[1];
                    document.querySelectorAll('#joystick-list span').forEach(span => {
                        span.style.letterSpacing = myLetterSpacing + 'px';
                        span.style.margin = myWordMargin + 'px';
                    });
                }

                // Farbe ändern (Button 0 + Stick)
                if (gamepad.buttons[0].pressed) {
                    red += gamepad.axes[0] * 5;
                    green += gamepad.axes[1] * 5;
                    red = Math.max(0, Math.min(255, red));
                    green = Math.max(0, Math.min(255, green));
                    let currentColor = `rgb(${Math.round(red)},${Math.round(green)},255)`;
                    document.querySelectorAll('#joystick-list span').forEach(span => {
                        span.style.color = currentColor;
                    });
                }

                // Seite neu laden (Button 16)
                if (gamepad.buttons[16] && gamepad.buttons[16].pressed) {
                    location.reload();
                }
            }

            requestAnimationFrame(checkGamepad);
        }
        checkGamepad();
    </script>
</body>

</html>